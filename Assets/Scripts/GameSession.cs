using UnityEngine;
using UnityEngine.SceneManagement;

public class GameSession : MonoBehaviour
{
    private string[] linesRows;
    private bool isEmpty;
    private string initialData = "ID:1|Scene_name:StartStory1|Speaker_name:Aunty|Text:Oh, my sweet nephew! You grew up so fast. It's time to let you go. Maybe you'll find the New World your parents had always tried to reach... I'm so nervous.|Avatar_link:Assets/Sprites/Cat/Avatars/Idle (1.5).png|;ID:2|Scene_name:StartStory1|Speaker_name:Player|Text:Don't worry, aunty. I'll be fine! All the doors are open to me! This world is so big. I have no doubts that I'll discover that place *whispers* at all costs... |Avatar_link:Assets/Sprites/Cat/Avatars/Cat_avatar.png|;ID:3|Scene_name:StartStory1|Speaker_name:Brother|Text:I'll miss you so much... Come back as fast as you can! I don't know how to live if you are not here...|Avatar_link:Assets/Sprites/Cat/Avatars/Idle (1.4).png|;ID:4|Scene_name:StartStory1|Speaker_name:Player|Text:Of course, sweety! I'll take you all with me. But while far away, I'm going to miss all of you...|Avatar_link:Assets/Sprites/Cat/Avatars/Cat_avatar.png|;ID:5|Scene_name:StartStory1|Speaker_name:Oshi|Text:It's hard to go away from family. You'll face different challenges. And at the end of the day you won't be the same... Oh, Higher Powers, help him!|Avatar_link:Assets/Sprites/Cat/Avatars/Idle (1.7).png|;ID:6|Scene_name:StartStory1|Speaker_name:Player|Text:Thank you, Oshi. It's time to go.|Avatar_link:Assets/Sprites/Cat/Avatars/Cat_avatar.png|;ID:7|Scene_name:SeaStory1|Speaker_name:Player|Text:Oh, hi! Is your ship leaving?|Avatar_link:Assets/Sprites/Cat/Avatars/Cat_avatar.png|;ID:8|Scene_name:SeaStory1|Speaker_name:Jo|Text:Ahoy! Look who's there! Yep, we stopped only to refill our stocks.|Avatar_link:Assets/Sprites/Supporters/Avatars/pirate1_avatar.png|;ID:9|Scene_name:SeaStory1|Speaker_name:Player|Text:May I join you? I need to get to the opposite shore.|Avatar_link:Assets/Sprites/Cat/Avatars/Cat_avatar.png|;ID:10|Scene_name:SeaStory1|Speaker_name:Billy|Text:Well, I don't really know. We already have enough weight on the ship.|Avatar_link:Assets/Sprites/Supporters/Avatars/pirate2_avatar.png|;ID:11|Scene_name:SeaStory1|Speaker_name:Jo|Text:Come on, Billy! This youngter may become a good company for Michie. You know his current mood.|Avatar_link:Assets/Sprites/Supporters/Avatars/pirate1_avatar.png|;ID:12|Scene_name:SeaStory1|Speaker_name:Billy|Text:Oh, fine... Get on the board!|Avatar_link:Assets/Sprites/Supporters/Avatars/pirate2_avatar.png|;ID:13|Scene_name:SeaStory1|Speaker_name:Player|Text:Thanks!|Avatar_link:Assets/Sprites/Cat/Avatars/Cat_avatar.png|;ID:14|Scene_name:SeaStory2|Speaker_name:Player|Text:Hi, Michie. Nice to meet you.|Avatar_link:Assets/Sprites/Cat/Avatars/Cat_avatar.png|;ID:15|Scene_name:SeaStory2|Speaker_name:Michie|Text:Hi. I suppose you're my new roommate.|Avatar_link:Assets/Sprites/Supporters/Avatars/Parrot_avatar_beads.png|;ID:16|Scene_name:SeaStory2|Speaker_name:Player|Text:Kind of. I'm off to find the New World!|Avatar_link:Assets/Sprites/Cat/Avatars/Cat_avatar.png|;ID:17|Scene_name:SeaStory2|Speaker_name:Michie|Text:Ha-ha. The only thing you'll find here is complete loss.|Avatar_link:Assets/Sprites/Supporters/Avatars/Parrot_avatar_beads.png|;ID:18|Scene_name:SeaStory2|Speaker_name:Player|Text:...|Avatar_link:Assets/Sprites/Cat/Avatars/Cat_avatar.png|;ID:19|Scene_name:SeaStory2|Speaker_name:Michie|Text:Have you ever been away from your place for a long time?! It is awful. It is scareful. You know nothing about what you're going to face...|Avatar_link:Assets/Sprites/Supporters/Avatars/Parrot_avatar_beads.png|;ID:20|Scene_name:SeaStory2|Speaker_name:Player|Text:Well, sometimes I'm sad but...|Avatar_link:Assets/Sprites/Cat/Avatars/Cat_avatar.png|;ID:21|Scene_name:SeaStory2|Speaker_name:Michie|Text:Shock. Dissapointment. Feeling of being disconnected from the real world. Like your body doesn't suit you anymore. You want to run away, but you are stuck.|Avatar_link:Assets/Sprites/Supporters/Avatars/Parrot_avatar_beads.png|;ID:22|Scene_name:SeaStory2|Speaker_name:Player|Text:I see what this is about... Look, I'm here not to blame you for your feelings. I'm sure that you have the reasons to feel the way you do. Maybe there's something I can do for you?|Avatar_link:Assets/Sprites/Cat/Avatars/Cat_avatar.png|;ID:23|Scene_name:SeaStory2|Speaker_name:Michie|Text:Nothing. All I want is to... Damn!|Avatar_link:Assets/Sprites/Supporters/Avatars/Parrot_avatar_beads.png|;ID:24|Scene_name:SeaStory2|Speaker_name:Michie|Text:Damn, damn, damn! Those beads are everywhere!|Avatar_link:Assets/Sprites/Supporters/Avatars/Parrot_avatar.png|;ID:25|Scene_name:SeaStory2|Speaker_name:Player|Text:Don't worry! It's okay. Everything is fine. Breathe in and breathe out. I'll get them.|Avatar_link:Assets/Sprites/Cat/Avatars/Cat_avatar.png|;ID:26|Scene_name:IslandStory1|Speaker_name:Player|Text:Where am I? This place looks so unusual and... hostile.|Avatar_link:Assets/Sprites/Cat/Avatars/Cat_avatar.png|;ID:27|Scene_name:IslandStory1|Speaker_name:Blisk|Text:Welcome to our island! Feel free to do whatever you want to!|Avatar_link:Assets/Sprites/Supporters/Avatars/Blisk_avatar.png|;ID:28|Scene_name:IslandStory1|Speaker_name:Player|Text:Oh, hi. Do you live here?|Avatar_link:Assets/Sprites/Cat/Avatars/Cat_avatar.png|;ID:29|Scene_name:IslandStory1|Speaker_name:Blisk|Text:Yep, my house is over there.|Avatar_link:Assets/Sprites/Supporters/Avatars/Blisk_avatar.png|;ID:30|Scene_name:IslandStory1|Speaker_name:Player|Text:But shouldn't you live... in the water?|Avatar_link:Assets/Sprites/Cat/Avatars/Cat_avatar.png|;ID:31|Scene_name:IslandStory1|Speaker_name:Blisk|Text:It is so cruel of you. Why do you even care?|Avatar_link:Assets/Sprites/Supporters/Avatars/Blisk_avatar.png|;ID:32|Scene_name:IslandStory1|Speaker_name:Player|Text:Sorry! I didn't mean to offend you. It's definetely up to you.|Avatar_link:Assets/Sprites/Cat/Avatars/Cat_avatar.png|;ID:33|Scene_name:IslandStory1|Speaker_name:Player|Text:I was just worried about you. It seems like your natural habitat is supposed to be water...|Avatar_link:Assets/Sprites/Cat/Avatars/Cat_avatar.png|;ID:34|Scene_name:IslandStory1|Speaker_name:Blisk|Text:Well, probably it is... But it doesn't matter. I was thrown here by the ocean and locals helped me a lot! Now I'm just like them.|Avatar_link:Assets/Sprites/Supporters/Avatars/Blisk_avatar.png|;ID:35|Scene_name:IslandStory1|Speaker_name:Player|Text:I'm glad they've cared about you. So, you didn't try to go back to ocean?|Avatar_link:Assets/Sprites/Cat/Avatars/Cat_avatar.png|;ID:36|Scene_name:IslandStory1|Speaker_name:Blisk|Text:Never! Why would I? This is my home now and I feel good here.|Avatar_link:Assets/Sprites/Supporters/Avatars/Blisk_avatar.png|;ID:37|Scene_name:IslandStory1|Speaker_name:Player|Text:I just have concerns about your physical condition? Is everything great?|Avatar_link:Assets/Sprites/Cat/Avatars/Cat_avatar.png|;ID:38|Scene_name:IslandStory1|Speaker_name:Blisk|Text:Well, I have troubles breathing and moving here, but I think this is the way it has to be.|Avatar_link:Assets/Sprites/Supporters/Avatars/Blisk_avatar.png|;ID:39|Scene_name:IslandStory1|Speaker_name:Player|Text:Oh, honey... Maybe you should try going back to the ocean? It doesn't mean you have to stay there. But I reckon you have to try.|Avatar_link:Assets/Sprites/Cat/Avatars/Cat_avatar.png|;ID:40|Scene_name:IslandStory1|Speaker_name:Blisk|Text:Look, it is not such a problem. Breating is as much important as... Oh... Feels like another seizure... Help?|Avatar_link:Assets/Sprites/Supporters/Avatars/Blisk_avatar.png|;ID:41|Scene_name:IslandStory1|Speaker_name:Player|Text:Oh, God... I must fill the backet.|Avatar_link:Assets/Sprites/Cat/Avatars/Cat_avatar.png|;ID:42|Scene_name:IslandStory2|Speaker_name:Blisk|Text:Wow... Thank you... Probably you were right... I gotta try.|Avatar_link:Assets/Sprites/Supporters/Avatars/Blisk_avatar.png|;ID:43|Scene_name:IslandStory2|Speaker_name:Player|Text:No problem. I'm glad you decided so.|Avatar_link:Assets/Sprites/Cat/Avatars/Cat_avatar.png|;ID:44|Scene_name:IslandStory2|Speaker_name:Blisk|Text:But what about you? What are you doing here?|Avatar_link:Assets/Sprites/Supporters/Avatars/Blisk_avatar.png|;ID:45|Scene_name:IslandStory2|Speaker_name:Player|Text:Oh, I'm... I'm on my way to the New World! I want to reach this place at all cost.|Avatar_link:Assets/Sprites/Cat/Avatars/Cat_avatar.png|;ID:46|Scene_name:IslandStory2|Speaker_name:Blisk|Text:But... For what?|Avatar_link:Assets/Sprites/Supporters/Avatars/Blisk_avatar.png|;ID:47|Scene_name:IslandStory2|Speaker_name:Player|Text:Well, I... It's... It's the place where all dreams come true! The grass is greener and the sky is bluer!|Avatar_link:Assets/Sprites/Cat/Avatars/Cat_avatar.png|;ID:48|Scene_name:IslandStory2|Speaker_name:Blisk|Text:And what about your tribe?|Avatar_link:Assets/Sprites/Supporters/Avatars/Blisk_avatar.png|;ID:49|Scene_name:IslandStory2|Speaker_name:Player|Text:They will go after me! We'll live our happy life together. There.|Avatar_link:Assets/Sprites/Cat/Avatars/Cat_avatar.png|;ID:50|Scene_name:IslandStory2|Speaker_name:Blisk|Text:But... Are you sure they will come after you? Seems like most of them already have the life they wanted.|Avatar_link:Assets/Sprites/Supporters/Avatars/Blisk_avatar.png|;ID:51|Scene_name:IslandStory2|Speaker_name:Player|Text:Of course they will! Because... because...|Avatar_link:Assets/Sprites/Cat/Avatars/Cat_avatar.png|;ID:52|Scene_name:IslandStory2|Speaker_name:Player|Text:I don't know... I've always thought I'm doing this for them, but now... Maybe nobody needs it...|Avatar_link:Assets/Sprites/Cat/Avatars/Cat_avatar.png|;ID:53|Scene_name:IslandStory2|Speaker_name:Blisk|Text:Looks like you've got a lot of things to think about...|Avatar_link:Assets/Sprites/Supporters/Avatars/Blisk_avatar.png|;ID:54|Scene_name:MetropolisStory1|Speaker_name:Player|Text:Looks... oppressive...|Avatar_link:Assets/Sprites/Cat/Avatars/Cat_avatar.png|;ID:55|Scene_name:MetropolisStory1|Speaker_name:Bummy|Text:Isn't it? Always had the same feeling.|Avatar_link:Assets/Sprites/Supporters/Avatars/Bug_avatar.png|;ID:56|Scene_name:MetropolisStory1|Speaker_name:Player|Text:Hey. How is it going?|Avatar_link:Assets/Sprites/Cat/Avatars/Cat_avatar.png|;ID:57|Scene_name:MetropolisStory1|Speaker_name:Bummy|Text:Pretty awful. I'm just stuck here. Every day is the same.|Avatar_link:Assets/Sprites/Supporters/Avatars/Bug_avatar.png|;ID:58|Scene_name:MetropolisStory1|Speaker_name:Player|Text:Look, you gotta change the place! I don't understand how you live here.|Avatar_link:Assets/Sprites/Cat/Avatars/Cat_avatar.png|;ID:59|Scene_name:MetropolisStory1|Speaker_name:Bummy|Text:Its just... I don't know if I can. And if there is any sense. The world is tough. Once you feel the greatest, the next moment you are just noone.|Avatar_link:Assets/Sprites/Supporters/Avatars/Bug_avatar.png|;ID:60|Scene_name:MetropolisStory1|Speaker_name:Player|Text:I see... I also have some doubts. It feels like I'm not going to make it. I keep going and going, but... there's no end...|Avatar_link:Assets/Sprites/Cat/Avatars/Cat_avatar.png|;ID:61|Scene_name:MetropolisStory1|Speaker_name:Bummy|Text:Yeah... I have an idea. You may join me if you'd like to. Happiness can be found even in the darkest times.|Avatar_link:Assets/Sprites/Supporters/Avatars/Bug_avatar.png|;ID:62|Scene_name:DesertStory1|Speaker_name:Player|Text:Hello? Is anybody here?|Avatar_link:Assets/Sprites/Cat/Avatars/Cat_sad_avatar.png|;ID:63|Scene_name:DesertStory1|Speaker_name:Someone|Text:Please... don't bother me...|Avatar_link:Assets/Sprites/Supporters/Avatars/Empty.png|;ID:64|Scene_name:DesertStory1|Speaker_name:Player|Text:Oh, em... hi. I'm just looking for...|Avatar_link:Assets/Sprites/Cat/Avatars/Cat_sad_avatar.png|;ID:65|Scene_name:DesertStory1|Speaker_name:Someone|Text:I'm begging you, please! Just go!|Avatar_link:Assets/Sprites/Supporters/Avatars/Empty.png|;ID:66|Scene_name:DesertStory1|Speaker_name:Player|Text:Sorry... sorry... I just wanted to...|Avatar_link:Assets/Sprites/Cat/Avatars/Cat_sad_avatar.png|;ID:67|Scene_name:DesertStory1|Speaker_name:Someone|Text:Screw it.|Avatar_link:Assets/Sprites/Supporters/Avatars/Empty.png|;ID:68|Scene_name:DesertStory2|Speaker_name:Spooker|Text:What. Ask and get out.|Avatar_link:Assets/Sprites/Supporters/Avatars/Spooker_avatar.png|;ID:69|Scene_name:DesertStory2|Speaker_name:Player|Text:I'm so sorry, but... what happend to you?|Avatar_link:Assets/Sprites/Cat/Avatars/Cat_sad_avatar.png|;ID:70|Scene_name:DesertStory2|Speaker_name:Spooker|Text:Frustration. Hopelessness. Depression. Feeling that nothing matters. Pick whatever you want.|Avatar_link:Assets/Sprites/Supporters/Avatars/Spooker_avatar.png|;ID:71|Scene_name:DesertStory2|Speaker_name:Player|Text:Depression. Represents me the best now.|Avatar_link:Assets/Sprites/Cat/Avatars/Cat_crying_avatar.png|;ID:72|Scene_name:DesertStory2|Speaker_name:Spooker|Text:Same. I just can't get myself together. It hard to sleep, to think, to do... anything...|Avatar_link:Assets/Sprites/Supporters/Avatars/Spooker_avatar.png|;ID:73|Scene_name:DesertStory2|Speaker_name:Player|Text:I understand. It's like you're the one who messed your life...|Avatar_link:Assets/Sprites/Cat/Avatars/Cat_crying_avatar.png|;ID:74|Scene_name:DesertStory2|Speaker_name:Spooker|Text:A failure. This pain is so strong that you try to convert it to... physical pain...|Avatar_link:Assets/Sprites/Supporters/Avatars/Spooker_avatar.png|;ID:75|Scene_name:DesertStory2|Speaker_name:Player|Text:You think about everything you've done and the purpose. But... there's no sense in any of things you wanted before. For what? Life is meaningless.|Avatar_link:Assets/Sprites/Cat/Avatars/Cat_crying_avatar.png|;ID:76|Scene_name:DesertStory2|Speaker_name:Spooker|Text:Sometimed I start thinking about... about ending this. All of this. You know what I mean.|Avatar_link:Assets/Sprites/Supporters/Avatars/Spooker_avatar.png|;ID:77|Scene_name:DesertStory2|Speaker_name:Player|Text:I'm afraid so. |Avatar_link:Assets/Sprites/Cat/Avatars/Cat_crying_avatar.png|;ID:78|Scene_name:DesertStory2|Speaker_name:Spooker|Text:I don't know what to do. |Avatar_link:Assets/Sprites/Supporters/Avatars/Spooker_avatar.png|;ID:79|Scene_name:DesertStory2|Speaker_name:Player|Text:So do I...|Avatar_link:Assets/Sprites/Cat/Avatars/Cat_crying_avatar.png|;ID:80|Scene_name:ForestStory1|Speaker_name:Tiffy|Text:Hello, dear? Do you need any help?|Avatar_link:Assets/Sprites/Supporters/Avatars/Tiffy_avatar.png|;ID:81|Scene_name:ForestStory1|Speaker_name:Player|Text:Oh, hi... I... I actually do. I need to talk to someone.|Avatar_link:Assets/Sprites/Cat/Avatars/Cat_avatar.png|;ID:82|Scene_name:ForestStory1|Speaker_name:Tiffy|Text:Talk? Go on!|Avatar_link:Assets/Sprites/Supporters/Avatars/Tiffy_avatar.png|;ID:83|Scene_name:ForestStory1|Speaker_name:Player|Text:Well... I'm searching for The New World. If you know what I'm talking about. But during my trip so many things happened...|Avatar_link:Assets/Sprites/Cat/Avatars/Cat_avatar.png|;ID:84|Scene_name:ForestStory1|Speaker_name:Player|Text:Firstly I was excited, but now... I'm not sure if its the right thing to do. I'm so far away from home, I'm exhausted and I have no clue how long this is going to take.|Avatar_link:Assets/Sprites/Cat/Avatars/Cat_avatar.png|;ID:85|Scene_name:ForestStory1|Speaker_name:Player|Text:I feel like... I lost myself... I'm hesitating if my tribe actually needs it. Maybe finding this place has always been my selfish purpose.|Avatar_link:Assets/Sprites/Cat/Avatars/Cat_avatar.png|;ID:86|Scene_name:ForestStory1|Speaker_name:Tiffy|Text:If it's like this, why don't you just turn back and head home? Although you have gotten so far, coming back is always an option.|Avatar_link:Assets/Sprites/Supporters/Avatars/Tiffy_avatar.png|;ID:87|Scene_name:ForestStory1|Speaker_name:Player|Text:This trip started from my parents. They have put their life to this. I feel that reaching the New World is my way to honor them. For everything they did.|Avatar_link:Assets/Sprites/Cat/Avatars/Cat_avatar.png|;ID:88|Scene_name:ForestStory1|Speaker_name:Tiffy|Text:Then I think you got all the answers you need.|Avatar_link:Assets/Sprites/Supporters/Avatars/Tiffy_avatar.png|;ID:89|Scene_name:VillageStory1|Speaker_name:Player|Text:Wow! Looks stunning!|Avatar_link:Assets/Sprites/Cat/Avatars/Cat_avatar.png|;ID:90|Scene_name:VillageStory1|Speaker_name:Barry|Text:Hi! Familiar figure.|Avatar_link:Assets/Sprites/Supporters/Avatars/Cat1_avatar.png|;ID:91|Scene_name:VillageStory1|Speaker_name:Player|Text:Yeah! God, I have lived my whole life not knowing that... creatures like me exist somewhere else!|Avatar_link:Assets/Sprites/Cat/Avatars/Cat_avatar.png|;ID:92|Scene_name:VillageStory1|Speaker_name:Okie|Text:Must be surprising, buddy. We live near the New World so our colors are.. different.|Avatar_link:Assets/Sprites/Supporters/Avatars/Cat2_avatar.png|;ID:93|Scene_name:VillageStory1|Speaker_name:Player|Text:The New World? Is it somewhere near?|Avatar_link:Assets/Sprites/Cat/Avatars/Cat_avatar.png|;ID:94|Scene_name:VillageStory1|Speaker_name:Mary|Text:Absolutely. If it's something you're looking for you are on the right way.|Avatar_link:Assets/Sprites/Supporters/Avatars/Cat3_avatar.png|;ID:95|Scene_name:VillageStory1|Speaker_name:Player|Text:I can't believe this... It's a place of all my wishes... What am I supposed to do now? When it's so close...|Avatar_link:Assets/Sprites/Cat/Avatars/Cat_avatar.png|;ID:96|Scene_name:VillageStory1|Speaker_name:Barry|Text:Well, it's up to you. You gotta make your own decision.|Avatar_link:Assets/Sprites/Supporters/Avatars/Cat1_avatar.png|;ID:97|Scene_name:VillageStory1|Speaker_name:Player|Text:Right... I'm going to get there!|Avatar_link:Assets/Sprites/Cat/Avatars/Cat_avatar.png|;ID:98|Scene_name:NewWorldStory1|Speaker_name:Yuki|Text:Welcome to the New World! Well-known place but not reachable for everyone.|Avatar_link:Assets/Sprites/Supporters/Avatars/Dragon_avatar.png|;ID:99|Scene_name:NewWorldStory1|Speaker_name:Player|Text:I can't believe my eyes... I'm here!|Avatar_link:Assets/Sprites/Cat/Avatars/Cat_avatar.png|;";

    void Awake()
    {
        int numGameSessions = FindObjectsOfType<GameSession>().Length;
        if (numGameSessions > 1)
        {
            Destroy(gameObject);
        }
        else
        {
            DontDestroyOnLoad(gameObject);
        }
        //StartCoroutine(OutputRoutine("http://localhost:3307/noviy_svit_db/LinesData.php"));
        InitializeData();
    } 

    // private IEnumerator OutputRoutine(string url)
    // {
    //     var linesData = new UnityWebRequest(url);
    //     linesData.downloadHandler = new DownloadHandlerBuffer();
    //     yield return linesData.SendWebRequest();
    //     string result = linesData.downloadHandler.text;
    //     while (!linesData.isDone) { }
    //     isEmpty = result == "";
    //     if (!isEmpty)
    //     {
    //         string linesDataString = result.Remove(result.Length - 1);
    //         linesRows = linesDataString.Split(';');
    //     }
    //     else
    //     {
    //         SceneManager.LoadScene("ServerError");
    //     }
    // }

    private void InitializeData(){
        isEmpty = initialData == "";
        if (!isEmpty)
        {
            string linesDataString = initialData.Remove(initialData.Length - 1);
            linesRows = linesDataString.Split(';');
        }
        else
        {
            SceneManager.LoadScene("ServerError");
        }
    }

    public string[] GetLinesRows()
    {
        return linesRows;
    }

    public void ResetGameSession()
    {
        SceneManager.LoadScene(SceneManager.GetActiveScene().buildIndex);
    }
}

